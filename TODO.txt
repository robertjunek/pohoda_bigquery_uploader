ğŸ“¦ KOMPLETNÃ SEZNAM SOUBORÅ®
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ HLAVNÃ SOUBORY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ sync_pohoda_to_bigquery.py  - HlavnÃ­ synchronizaÄnÃ­ skript
âœ“ config.json                  - Konfigurace (MS SQL, BigQuery, Sentry)
âœ“ veverka.json                 - Google Cloud credentials (jiÅ¾ existuje)
âœ“ requirements.txt             - Python zÃ¡vislosti

ğŸ“„ SQL DOTAZY (jiÅ¾ existujÃ­)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ FA.sql                       - Faktury
âœ“ PH.sql                       - Prodejky
âœ“ SKPP.sql                     - PÅ™Ã­jemky
âœ“ SKPV.sql                     - VÃ½dejky

ğŸ“„ POMOCNÃ‰ SKRIPTY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ setup_config.py              - InteraktivnÃ­ konfigurace
âœ“ test_connections.py          - Test pÅ™ipojenÃ­ k databÃ¡zÃ­m
âœ“ test_sync.sh                 - TestovacÃ­ spuÅ¡tÄ›nÃ­ synchronizace
âœ“ check_status.py              - Kontrola stavu poslednÃ­ sync

ğŸ“„ DOKUMENTACE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ README.md                    - KompletnÃ­ dokumentace
âœ“ QUICKSTART.md                - RychlÃ½ start
âœ“ ARCHITECTURE.md              - Diagram architektury
âœ“ crontab.example              - PÅ™Ã­klady cron jobÅ¯

ğŸ“„ OSTATNÃ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ Makefile                     - SnadnÃ© ovlÃ¡dÃ¡nÃ­ (make help)
âœ“ .gitignore                   - Git ignore (credentials atd.)


ğŸ¯ CO DÄšLAT TEÄ?
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

KROK 1: Konfigurace
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
make config
(nebo: python setup_config.py)

Zadej:
- MS SQL server adresu
- Database (obvykle "master")
- Username & password
- Sentry DSN (volitelnÃ©, mÅ¯Å¾eÅ¡ nechat prÃ¡zdnÃ©)


KROK 2: Test pÅ™ipojenÃ­
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
make test-conn
(nebo: python test_connections.py)

OvÄ›Å™Ã­:
- âœ“ MS SQL pÅ™ipojenÃ­
- âœ“ PÅ™Ã­stup k tabulce companies
- âœ“ BigQuery pÅ™ipojenÃ­
- âœ“ Existenci SQL souborÅ¯


KROK 3: TestovacÃ­ synchronizace
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
make test-sync
(nebo: ./test_sync.sh)

Provede:
- PÅ™ipojenÃ­ k obÄ›ma databÃ¡zÃ­m
- StaÅ¾enÃ­ dat z Pohody
- NahrÃ¡nÃ­ do BigQuery


KROK 4: NastavenÃ­ automatickÃ©ho spouÅ¡tÄ›nÃ­
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
crontab -e

PÅ™idej Å™Ã¡dek (napÅ™. kaÅ¾dÃ½ den ve 2:00):

0 2 * * * cd /home/robert/projekty/apoteka_veverka && .venv/bin/python sync_pohoda_to_bigquery.py >> cron.log 2>&1


ğŸ“Š MONITORING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Kontrola stavu:
  make status

Å½ivÃ© logy:
  make logs

PoslednÃ­ch 50 Å™Ã¡dkÅ¯:
  make logs-tail

Jen chyby:
  make logs-errors


ğŸ”§ VÅ ECHNY PÅ˜ÃKAZY (make help)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  make install      - Instalace zÃ¡vislostÃ­
  make config       - Konfigurace
  make test-conn    - Test pÅ™ipojenÃ­
  make test-sync    - Test synchronizace
  make sync         - SpuÅ¡tÄ›nÃ­ synchronizace
  make status       - Status poslednÃ­ sync
  make logs         - Å½ivÃ© sledovÃ¡nÃ­ logÅ¯
  make logs-tail    - PoslednÃ­ch 50 Å™Ã¡dkÅ¯
  make logs-errors  - Jen chyby
  make clean        - VyÄiÅ¡tÄ›nÃ­ logÅ¯


âš ï¸  CO JE POTÅ˜EBA UPRAVIT V CONFIG.JSON
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

{
  "mssql": {
    "server": "tvuj_server",           â† ZMÄšÅ‡
    "database": "master",               â† MOÅ½NÃ ZMÄšÅ‡
    "username": "tvuj_username",        â† ZMÄšÅ‡
    "password": "tvoje_heslo",          â† ZMÄšÅ‡
    "driver": "ODBC Driver 17 for SQL Server",  â† ZKONTROLUJ
    "timeout": 30
  },
  ...
  "sentry": {
    "dsn": "tvoje_sentry_dsn",          â† ZMÄšÅ‡ (nebo nech prÃ¡zdnÃ©)
    ...
  }
}


ğŸ› TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ "companies tabulka nenalezena"
â†’ Zkontroluj, Å¾e databÃ¡ze obsahuje tabulku "companies" s poli:
  - linked_server (varchar)
  - database (varchar)

âŒ "ODBC Driver nenalezen"
â†’ Nainstaluj:
  curl https://packages.microsoft.com/keys/microsoft.asc | sudo apt-key add -
  curl https://packages.microsoft.com/config/ubuntu/$(lsb_release -rs)/prod.list | sudo tee /etc/apt/sources.list.d/mssql-release.list
  sudo apt-get update
  sudo ACCEPT_EULA=Y apt-get install -y msodbcsql17

âŒ BigQuery oprÃ¡vnÄ›nÃ­ chyba
â†’ Service account (veverka.json) potÅ™ebuje role:
  - BigQuery Data Editor
  - BigQuery Job User


ğŸ“ DALÅ Ã POMOC
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“– README.md           - PodrobnÃ¡ dokumentace
ğŸ“– QUICKSTART.md       - RychlÃ½ prÅ¯vodce
ğŸ“– ARCHITECTURE.md     - Architektura a diagram
ğŸ“– crontab.example     - PÅ™Ã­klady cron nastavenÃ­

Logy: sync.log
Cron logy: cron.log
Sentry: https://sentry.io (pokud nakonfigurovÃ¡no)


âœ¨ HOTOVO!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VÅ¡e je pÅ™ipraveno. StaÄÃ­:
  1. make config
  2. make test-conn
  3. make test-sync
  4. PÅ™idat do crontab

HodnÄ› Å¡tÄ›stÃ­! ğŸš€
